print("SISTEMA DE RESERVA DE PELICULAS S.A")

sala={}
for a in range(1,51):
    sala[a]=True

sala1={"lunes":{"8":sala.copy(),"11":sala.copy(),"14":sala.copy(),"17":sala.copy(),"20":sala.copy()},"Martes":{"8":sala.copy(),"11":sala.copy(),"14":sala.copy(),"17":sala.copy(),"20":sala.copy()},"miercoles":{"8":sala.copy(),"11":sala.copy(),"14":sala.copy(),"17":sala.copy(),"20":sala.copy()},"jueves":{"8":sala.copy(),"11":sala.copy(),"14":sala.copy(),"17":sala.copy(),"20":sala.copy()},"viernes":{"8":sala.copy(),"11":sala.copy(),"14":sala.copy(),"17":sala.copy(),"20":sala.copy()},"sabado":{"8":sala.copy(),"11":sala.copy(),"14":sala.copy(),"17":sala.copy(),"20":sala.copy()},"domingo":{"8":sala.copy(),"11":sala.copy(),"14":sala.copy(),"17":sala.copy(),"20":sala.copy()}}
sala2=sala1.copy()
sala3=sala1.copy()
sala4=sala1.copy()
sala5=sala1.copy()
sala6=sala1.copy()
sala7=sala1.copy()
sala8=sala1.copy()

#pelicula_1 guardada en una tupla
pelicula_1=("Encantada","La bella princesa Giselle es transportada por un hechizo de la malvada reina Narissa desde su mágico mundo a la moderna y caótica Manhattan actual.Inmersa en un entorno que desconoce,Giselle deambula por un mundo desorganizado.","1h 47m",sala1) 

#pelicula_2 guardada en una tupla
pelicula_2=("Las guerreras del k-pop","Un supergrupo de k-pop usa sus poderes secretos para proteger a sus fans de amenazas sobrenaturales y de una banda rival de chicos decididos a robar corazones y mentes.","1h 36m",sala2)

#pelicula_3 guardada en una tupla
pelicula_3=("spiderman","Luego de sufrir la picadura de una araña genéticamente modificada, un estudiante de secundaria tímido y torpe adquiere increíbles capacidades como arácnido. Pronto comprenderá que su misión es utilizarlas para luchar contra el mal y defender a sus vecinos.","2h 6m",sala3)

#pelicula_4 guardada en una tupla
pelicula_4=("Intensa-Mente","Riley acaba de nacer y en el centro de control de su pequeña mente sólo hay sitio para Alegría. Poco después aparece Tristeza y, más tarde, Ira, Miedo y Asco. Las cinco emociones tendrán que ayudar a la niña cuando, ya con 11 años, su familia se mude desde su idílico pueblo del Medio Oeste estadounidense a la enorme e intimidante ciudad de San Francisco. Tras una serie de acontecimientos, Alegría y Tristeza tendrán que trabajar juntas para salvar a Riley.","1h 35m",sala4)

#pelicula_5 guardada en una tupla
pelicula_5=("Barbie","Después de ser expulsada de Barbieland por no ser una muñeca de aspecto perfecto, Barbie parte hacia el mundo humano para encontrar la verdadera felicidad.","1h 54m",sala5) 

#pelicula_6 guardada en una tupla
pelicula_6=("Cómo entrenar a tu dragón 3","El joven vikingo Hipo parece haber conseguido que dragones y humanos convivan en paz. Sin embargo, su sueño y el de los demás habitantes de la isla de Mema no es compartido por otros vikingos, especialmente por los brutales cazadores de dragones.","1h 44m",sala6)

#pelicula_7 guardada en una tupla
pelicula_7=("Hotel Transylvania","El nuevo y misterioso invento de Van Helsing transforma a Drac y sus amigos en humanos, y a Johnny en un monstruo. Con sus nuevos cuerpos, Drac y la manada deben encontrar la manera de revertirlo antes de que se se vuelva permanente.","1h 27m",sala7)

#pelicula_8 guardada en una tupla
pelicula_8=("turning red","Mei Lee, una niña de 13 años un poco rara pero segura de sí misma, que se debate entre seguir siendo la hija obediente que su madre quiere que sea y el caos de la adolescencia.","1h 40m",sala8)

peliculas=[pelicula_1,pelicula_2,pelicula_3,pelicula_4,pelicula_5,pelicula_6,pelicula_7,pelicula_8]

cuentas= {"yesi@gmail.com":"123"}#Diccionario con las cuentas registradas (correo,contraseña)
nombres_usuarios={"yesi@gmail.com":"Yesi"}
boleta_valor=10000 
descuento=0.10 #10% de descuento si la compra es mayor a 4 entradas
asiento_revervados=[]
comprobante=False
reservas=[]
while True:
    print("BIENVENIDO A LA PÁGINA DEL CINE MUNDO S.A")
    n=1 #Contador de intentos
    pregunta= input("1.Registrarse \n2.Ingresar\n\nIngresé su opción: ").lower()#Le preguntamos al usuario si quiere registrarse po ingresar .lower para convertir a minusculas

    contador= 1

    if pregunta=="2":
        while n<=3:#si el numero de intentos faliidos es mayor a 3 sera un error
            try:
                usuario= input("Ingresé su usuario (correo electronico): ")
                contraseña= input("Ingresé su contraseña: ")
                if contraseña==cuentas[usuario]:
                    print(f"Bienvenido a su cuenta {nombres_usuarios[usuario]}")
                    comprobante=True
                    break
                elif contraseña!=cuentas[usuario]:
                    print("Contraseña incorrecto")
                else:
                    print("No se pudo ingresar a su cuenta")
                n+=1
            except KeyError:
                if n<3:
                    print("Correo incorrecto")
                    n+=1
                else:
                    print("No se pudo ingresar a su cuenta")
                    break
    elif pregunta=="1":
        while True:
            nombre=input("Ingrese un apodo o su nombre (Por este se le llamará): ")
            usuario= input("Ingresé un correo electronico será su usuario : ")
            if "@gmail.com" in usuario or "@hotmail.com" in usuario or "@yahoo.com"  in usuario:
                if usuario in cuentas:
                    print("Error, el correo ya esta registrado")
                    continue
                else:
                    pass
            else:
                print("Error, el correo no es valido")
                continue
            contraseña= input("Ingresé una contraseña: ")
            cuentas[usuario]=contraseña
            nombres_usuarios[usuario]=nombre
            print(f"\nFELICIDADES, su cuenta a sido creada con éxito,{nombres_usuarios[usuario]}  \n Volvera a la página de ingreso donde beberá ingresar su usuario y contraseña")
            break #Volvemos al inicio del while para que ingrese a su cuenta

    else:
        print("Error, opción no valida")
    if comprobante:
        while True:
            print("MENU PRINCIPAL CINE MUNDO S.A")
            print("Opciones disponibles: \n\n1.Ver cartelera \n2.Reservar entradas \n3.Ver asientos disponibles  \n4.Ver mis reservas \n5.Salir")
            opcion=input("Ingresé su opción: ")
            if opcion=="1":
                print("CARTELERA DE PELICULAS DISPONIBLES")
                for i in range(len(peliculas)): #Recorremos la lista de peliculas
                    print("-".center(100,"-"))
                    print(f"{peliculas[i][0]} \n\nsinopsis: \n{peliculas[i][1]} \n\nDuración: {peliculas[i][2]}") #Mostramos el nombre, sinopsis y duración de la pelicula la i es una variable que va desde 0 hasta la cantida de peliculas se usa oara pedir 
                    print("-".center(100,"-")) #Linea decorativa
            elif opcion=="2":
                print("RESERVA DE ENTRADAS") 
                while True:
                    print("Peliculas disponibles para reservar entradas:")
                    for i in range(len(peliculas)):
                        print("-".center(100,"-"))
                        print(f"{peliculas[i][0]}") #Mostramos las peliculas disponibles solpo los npombres
                        print("-".center(100,"-"))
                    pelicula_reservar=input("Ingresé el nombre de la pelicula que desea reservar: ").lower()# Se le pregunta al usuario que pelicula deseas ver.lower para convertir a minusculas
                    j=[i[0].lower() for i in peliculas]
                    if pelicula_reservar in j:
                        pelicula=peliculas[j.index(pelicula_reservar)] #Guardamos la pelicula seleccionada en una variable
                        while True:
                            dia=input("Ingresé el día que desea ver la pelicula (lunes,martes,miércoles,jueves,viernes,sábado,domingo): ").lower()#.lower para convertir a minusculas
                            if dia in ["lunes","martes","miércoles","jueves","viernes","sábado","domingo"]:
                                while True:
                                    hora=input("Ingresé la hora que desea ver la pelicula (8,11,14,17,20): ")
                                    if hora in ["8","11","14","17","20"]:
                                        while True:
                                            asientos=[]
                                            asientoss=[i for i in pelicula[3][dia][hora].keys()]#Guardamos los asientos disponibles en una variable
                                            for i in range(len(asientoss)): #Recorremos el diccionario de asientos de la pelicula seleccionada
                                                if pelicula[3][dia][hora][i+1]==True: #Si el asiento esta disponible
                                                    asientos.append(asientoss[i])#Mostramos los asientos disponibles
                                            print(f"Asientos disponibles: \n{asientos}")
                                            while True:
                                                try:
                                                    asiento_cantidad=int(input(f"Ingresé la cantidad de asiento que desea reservar (1-{len(asientos)}):  "))
                                                    if asiento_cantidad>=len(asientos):
                                                        print("Error, cantidad de asientos no disponibles")
                                                        continue
                                                    else:
                                                        print("Número de ascientos aceptado")
                                                        asientos_revervados=[]
                                                        for i in range(asiento_cantidad):
                                                            reserva= int(input(f"Ingresé el número del asiento {i+1} que desea reservar: "))
                                                            if reserva in asientos:
                                                                asientos_revervados.append(reserva)
                                                                pelicula[3][dia][hora][reserva]=False
                                                            else:
                                                                print("Error, asiento no disponible")
                                                                continue

                                                        if len(asientos_revervados)>=4:
                                                            total_compra=(boleta_valor*asiento_cantidad)-(boleta_valor*asiento_cantidad*descuento)
                                                            print(f"Se le a aplicado un descuento del 10% por comprar más de 4 entradas")
                                                        else:
                                                            total_compra=boleta_valor*asiento_cantidad

                                                        reservas.append((nombres_usuarios[usuario],pelicula[0],dia,hora,asientos_revervados,total_compra))
                                                        print(f"Los asientos reservados fueron: {asientos_revervados} \n para la pelicula: {pelicula[0]} \n el día: {dia} \n a la hora: {hora} \n el valor total a pagar es de: ${total_compra}")
                                                        break
                                                                    
                                                except ValueError:
                                                    print("Error, ingrese un número")
                                                    continue
                                            break
                                            
                                                
                                    else:
                                        print("Error, hora incorrecta")
                                        continue
                                    break
                            else:
                                print("Error, dia incorrecto")
                                continue
                            break
                            
                    else:
                        print("Error, pelicula no disponible")
                        continue
                    break
            elif opcion=="3":
                print("ASIENTOS DISPONIBLES")
                while True:
                    print("Peliculas disponibles:")
                    for i in range(len(peliculas)):
                        print("-".center(100,"-"))
                        print(f"{peliculas[i][0]}") #Mostramos las peliculas disponibles solpo los npombres
                        print("-".center(100,"-"))
                    pelicula_reservar=input("Ingresé el nombre de la pelicula que desea revisar: ").lower()# Se le pregunta al usuario que pelicula deseas ver.lower para convertir a minusculas
                    j=[i[0].lower() for i in peliculas]
                    if pelicula_reservar in j:
                        pelicula=peliculas[j.index(pelicula_reservar)] #Guardamos la pelicula seleccionada en una variable
                        while True:
                            dia=input("Ingresé el día que desea revisar (lunes,martes,miércoles,jueves,viernes,sábado,domingo): ").lower()#.lower para convertir a minusculas
                            if dia in ["lunes","martes","miércoles","jueves","viernes","sábado","domingo"]:
                                while True:
                                    hora=input("Ingresé la hora que revisar(8,11,14,17,20): ")
                                    if hora in ["8","11","14","17","20"]:
                                        while True:
                                            asientos=[]
                                            asientoss=[i for i in pelicula[3][dia][hora].keys()]#Guardamos los asientos disponibles en una variable
                                            for i in range(len(asientoss)): #Recorremos el diccionario de asientos de la pelicula seleccionada
                                                if pelicula[3][dia][hora][i+1]==True: #Si el asiento esta disponible
                                                    asientos.append(asientoss[i])#Mostramos los asientos disponibles
                                            print(f"Asientos disponibles: \n{asientos}")
                                            break
            elif opcion=="4":
                print("MIS RESERVAS")
                reservass=[]
                for i in range(len(reservas)):
                    if reservas[i][0]==nombres_usuarios[usuario]:
                        reservass.append(reservas[i])
                if len(reservass)==0:
                    print("No tiene reservas")
                else:
                    for i in range(len(reservass)):
                        print("-".center(100,"-"))
                        print(f"Reserva {i+1}: \nNombre: {reservass[i][0]} \nPelicula: {reservass[i][1]} \nDía: {reservass[i][2]} \nHora: {reservass[i][3]} \nAsientos: {reservass[i][4]} \nValor total pagado: ${reservass[i][5]}")
                        print("-".center(100,"-"))
            elif opcion=="5":
                print("Gracias por usar el sistema de reservas del cine mundo S.A")
                comprobante=False
                break
            else:
                print("Error, opción no valida")
    
    break
